{
  "problem_id": "4",
  "problem_statement": "Find the characteristic polynomials of the following matrices. Are any of the matrices similar? [Hint: for no case do you need to construct a change of basis matrix that transforms one matrix into another.]\n\\[\n\\left(\\begin{array}{ccc}\n2 & 6 & 0 \\\\\n1 & 1 & 0 \\\\\n1 & -2 & 3\n\\end{array}\\right), \\quad\\left(\\begin{array}{ccc}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & -1\n\\end{array}\\right), \\quad\\left(\\begin{array}{ccc}\n0 & 1 & 0 \\\\\n0 & 0 & 1 \\\\\n-1 & 1 & 1\n\\end{array}\\right), \\quad\\left(\\begin{array}{ccc}\n-1 & 1 & 1 \\\\\n0 & 3 & 0 \\\\\n0 & 0 & 4\n\\end{array}\\right) .\n\\]",
  "relevant_chapters": [2, 3],
  "classification": {
    "primary_archetype": "characteristic polynomial computation and similarity invariants",
    "secondary_archetypes": [
      "determinant calculation via cofactor expansion",
      "algebraic invariant comparison"
    ],
    "confidence": 0.95,
    "reasoning": "This is a straightforward computation problem requiring calculation of det(A - λI) for each matrix, followed by comparison of similarity invariants (characteristic polynomials, eigenvalues, and their multiplicities) to determine which matrices might be similar. The hint suggests we should use invariants rather than explicit construction."
  },
  "strategies": [
    {
      "id": "s1",
      "approach_name": "Direct characteristic polynomial computation with similarity test via invariants",
      "confidence": 0.95,
      "attack_plan": [
        "For each matrix A, compute det(A - λI) by cofactor expansion, choosing the most convenient row or column",
        "Simplify each characteristic polynomial to standard form",
        "Compare characteristic polynomials: identical polynomials are necessary (but not sufficient) for similarity",
        "For matrices with the same characteristic polynomial, check additional invariants such as diagonalizability or geometric multiplicities",
        "Conclude which pairs (if any) are similar based on complete invariant matching"
      ],
      "hints": {
        "tier1_conceptual": "The characteristic polynomial is a similarity invariant, meaning similar matrices have the same characteristic polynomial. Computing det(A - λI) for each matrix will give you a key piece of information. But be careful: having the same characteristic polynomial doesn't guarantee similarity—you need to check further properties.",
        "tier2_strategic": "Use cofactor expansion (KB: linalg_ii_ht2026.ch2.thm.1) to compute det(A - λI). For triangular or near-triangular matrices, the characteristic polynomial can be read almost immediately from the diagonal. For the first and third matrices, expand along a row or column with zeros. Once you have all four polynomials, compare them: if two matrices have different characteristic polynomials, they cannot be similar. If they have the same polynomial, you need to check whether they have the same Jordan normal form or whether they're both diagonalizable with the same eigenspace dimensions.",
        "tier3_outline": "Matrix 1: A - λI has a zero in position (1,3), (2,3). Expand along column 3 to get det(A - λI) = (3-λ) det((2-λ, 6; 1, 1-λ)). The 2×2 determinant is (2-λ)(1-λ) - 6 = λ² - 3λ + 2 - 6 = λ² - 3λ - 4 = (λ-4)(λ+1). So χ₁(λ) = -(λ-3)(λ-4)(λ+1).\n\nMatrix 2: Diagonal matrix with diagonal entries 1, 1, -1. Characteristic polynomial is χ₂(λ) = (1-λ)(1-λ)(-1-λ) = -(1-λ)²(1+λ).\n\nMatrix 3: Expand det(A - λI) = det((-λ, 1, 0; 0, -λ, 1; -1, 1, 1-λ)) along the first row. You get -λ det((-λ, 1; 1, 1-λ)) - 1·det((0, 1; -1, 1-λ)) = -λ(-λ(1-λ) - 1) - (0·(1-λ) + 1) = -λ(-λ + λ² - 1) - 1 = λ² - λ³ + λ - 1. Factor: χ₃(λ) = -λ³ + λ² + λ - 1 = -(λ³ - λ² - λ + 1) = -(λ-1)(λ²-1) = -(λ-1)²(λ+1).\n\nMatrix 4: Upper triangular, so χ₄(λ) = (-1-λ)(3-λ)(4-λ) = -(1+λ)(3-λ)(4-λ).\n\nCompare: Matrices 2 and 3 have the same characteristic polynomial χ(λ) = -(1-λ)²(1+λ). Check if they're similar: Matrix 2 is diagonal, so if similar, Matrix 3 must also be diagonalizable. Check the geometric multiplicity of eigenvalue 1 in Matrix 3 by finding dim ker(A₃ - I). If dim = 2, they're similar; if dim = 1, they have different Jordan forms and are not similar."
      },
      "solution": "Let A₁, A₂, A₃, A₄ denote the four given matrices in order.\n\n**Matrix 1:**\nA₁ = [[2, 6, 0], [1, 1, 0], [1, -2, 3]]\n\nWe compute det(A₁ - λI):\nA₁ - λI = [[2-λ, 6, 0], [1, 1-λ, 0], [1, -2, 3-λ]]\n\nExpanding along the third column (which has two zeros), we get:\ndet(A₁ - λI) = (3-λ) · det([[2-λ, 6], [1, 1-λ]])\n                = (3-λ)[(2-λ)(1-λ) - 6]\n                = (3-λ)[2 - 2λ - λ + λ² - 6]\n                = (3-λ)[λ² - 3λ - 4]\n                = (3-λ)(λ - 4)(λ + 1)\n\nSo χ₁(λ) = -(λ - 3)(λ - 4)(λ + 1) = -(λ³ - 7λ² + 7λ + 12) (expanding to standard form).\n\nAlternatively, in factored form: χ₁(λ) has roots λ = 3, 4, -1 (all distinct).\n\n**Matrix 2:**\nA₂ = [[1, 0, 0], [0, 1, 0], [0, 0, -1]]\n\nThis is diagonal, so:\nχ₂(λ) = (1 - λ)(1 - λ)(-1 - λ) = (1 - λ)²(-1 - λ)\n\nRoots: λ = 1 (multiplicity 2), λ = -1 (multiplicity 1).\n\n**Matrix 3:**\nA₃ = [[0, 1, 0], [0, 0, 1], [-1, 1, 1]]\n\nWe compute:\nA₃ - λI = [[-λ, 1, 0], [0, -λ, 1], [-1, 1, 1-λ]]\n\nExpanding along the first row:\ndet(A₃ - λI) = -λ · det([[-λ, 1], [1, 1-λ]]) - 1 · det([[0, 1], [-1, 1-λ]]) + 0\n\ndet([[-λ, 1], [1, 1-λ]]) = -λ(1-λ) - 1 = -λ + λ² - 1 = λ² - λ - 1\n\ndet([[0, 1], [-1, 1-λ]]) = 0·(1-λ) - 1·(-1) = 1\n\nSo: det(A₃ - λI) = -λ(λ² - λ - 1) - 1 = -λ³ + λ² + λ - 1\n\nFactoring: -λ³ + λ² + λ - 1 = -(λ³ - λ² - λ + 1) = -(λ²(λ - 1) - (λ - 1)) = -(λ - 1)(λ² - 1) = -(λ - 1)(λ - 1)(λ + 1) = -(λ - 1)²(λ + 1)\n\nSo χ₃(λ) = -(λ - 1)²(λ + 1).\n\nRoots: λ = 1 (multiplicity 2), λ = -1 (multiplicity 1).\n\n**Matrix 4:**\nA₄ = [[-1, 1, 1], [0, 3, 0], [0, 0, 4]]\n\nThis is upper triangular, so the characteristic polynomial is the product of (diagonal entry - λ):\nχ₄(λ) = (-1 - λ)(3 - λ)(4 - λ)\n\nRoots: λ = -1, 3, 4 (all distinct).\n\n**Comparison:**\n- χ₁(λ) has roots {3, 4, -1} (all distinct)\n- χ₂(λ) = -(1 - λ)²(1 + λ) has roots {1, 1, -1}\n- χ₃(λ) = -(1 - λ)²(1 + λ) has roots {1, 1, -1}\n- χ₄(λ) has roots {-1, 3, 4} (all distinct)\n\nMatrices A₂ and A₃ have the same characteristic polynomial! This is necessary but not sufficient for similarity.\n\n**Testing similarity of A₂ and A₃:**\n\nSince A₂ is diagonal (hence diagonalizable), if A₂ and A₃ are similar, then A₃ must also be diagonalizable. A matrix is diagonalizable if and only if for each eigenvalue, its geometric multiplicity equals its algebraic multiplicity.\n\nFor A₃:\n- Eigenvalue λ = 1 has algebraic multiplicity 2\n- Eigenvalue λ = -1 has algebraic multiplicity 1\n\nWe need to check the geometric multiplicity of λ = 1, i.e., dim(ker(A₃ - I)).\n\nA₃ - I = [[-1, 1, 0], [0, -1, 1], [-1, 1, 0]]\n\nRow reducing:\n[[-1, 1, 0], [0, -1, 1], [-1, 1, 0]] → [[-1, 1, 0], [0, -1, 1], [0, 0, 0]] (subtract row 1 from row 3)\n\nFrom row 2: -y + z = 0, so z = y.\nFrom row 1: -x + y = 0, so x = y.\n\nSo ker(A₃ - I) = {(t, t, t) : t ∈ ℝ} has dimension 1.\n\nSince the geometric multiplicity (1) is less than the algebraic multiplicity (2) for eigenvalue 1, matrix A₃ is NOT diagonalizable.\n\nSince A₂ is diagonalizable but A₃ is not, they cannot be similar.\n\n**Conclusion:**\nNone of the matrices are similar to each other.\n\n- χ₁(λ) = -(λ - 3)(λ - 4)(λ + 1)\n- χ₂(λ) = -(λ - 1)²(λ + 1)\n- χ₃(λ) = -(λ - 1)²(λ + 1)\n- χ₄(λ) = -(λ + 1)(λ - 3)(λ - 4)\n\nMatrices A₂ and A₃ have the same characteristic polynomial but different Jordan forms (A₂ has two 1×1 Jordan blocks for eigenvalue 1, while A₃ has one 2×2 Jordan block for eigenvalue 1), so they are not similar.\n\nNo other pair shares the same characteristic polynomial, so no other pairs can be similar.",
      "solution_steps": [
        {
          "step": 1,
          "action": "Compute characteristic polynomial of A₁ by cofactor expansion along column 3",
          "justification": "Column 3 has two zeros, making cofactor expansion efficient. The determinant factors as (3-λ) times a 2×2 determinant.",
          "kb_references": ["linalg_ii_ht2026.ch2.thm.1"]
        },
        {
          "step": 2,
          "action": "Compute characteristic polynomial of A₂ by reading off diagonal",
          "justification": "For diagonal matrices, the characteristic polynomial is the product of (diagonal entry - λ).",
          "kb_references": []
        },
        {
          "step": 3,
          "action": "Compute characteristic polynomial of A₃ by cofactor expansion along row 1",
          "justification": "Row 1 has a zero in position (1,3), reducing computational complexity. The resulting polynomial can be factored by grouping.",
          "kb_references": ["linalg_ii_ht2026.ch2.thm.1"]
        },
        {
          "step": 4,
          "action": "Compute characteristic polynomial of A₄ by reading off diagonal",
          "justification": "Upper triangular matrices have characteristic polynomial equal to the product of (diagonal entry - λ).",
          "kb_references": []
        },
        {
          "step": 5,
          "action": "Compare all four characteristic polynomials",
          "justification": "Similarity implies equal characteristic polynomials (similarity invariant), so different polynomials rule out similarity.",
          "kb_references": []
        },
        {
          "step": 6,
          "action": "Identify that A₂ and A₃ have the same characteristic polynomial χ(λ) = -(λ-1)²(λ+1)",
          "justification": "Equal characteristic polynomials are necessary but not sufficient for similarity. We must check further invariants.",
          "kb_references": []
        },
        {
          "step": 7,
          "action": "Check diagonalizability of A₃ by computing geometric multiplicity of eigenvalue 1",
          "justification": "A₂ is diagonal (hence diagonalizable). If A₃ is also diagonalizable with the same eigenvalues and multiplicities, they are similar. If not, they cannot be similar.",
          "kb_references": []
        },
        {
          "step": 8,
          "action": "Row reduce A₃ - I to find dim(ker(A₃ - I))",
          "justification": "The geometric multiplicity equals the dimension of the kernel, which equals n - rank(A₃ - I).",
          "kb_references": []
        },
        {
          "step": 9,
          "action": "Conclude that dim(ker(A₃ - I)) = 1 < 2 = algebraic multiplicity",
          "justification": "This proves A₃ is not diagonalizable, so A₃ has a different Jordan form than A₂.",
          "kb_references": []
        },
        {
          "step": 10,
          "action": "Conclude that no matrices are similar",
          "justification": "A₁ and A₄ have different characteristic polynomials from all others (and from each other after checking roots). A₂ and A₃ have the same characteristic polynomial but different Jordan normal forms.",
          "kb_references": []
        }
      ],
      "potential_issues": [
        "In computing the characteristic polynomial of A₃, the factorization λ³ - λ² - λ + 1 = (λ-1)(λ²-1) requires careful algebraic manipulation. Double-check by expanding back.",
        "When row reducing A₃ - I, ensure that the third row is indeed a linear combination of the first two (it should be identical to row 1), confirming rank = 2 and nullity = 1.",
        "The sign conventions for characteristic polynomials vary: some sources use det(λI - A) while others use det(A - λI). Here we consistently use det(A - λI), but the leading coefficient alternates in sign depending on the dimension. For 3×3 matrices, det(A - λI) has leading term -λ³."
      ]
    }
  ],
  "recommended_strategy": "s1",
  "postmortem": {
    "key_insight": "Having the same characteristic polynomial is necessary but not sufficient for similarity. The characteristic polynomial only captures eigenvalues and their algebraic multiplicities, but similarity also requires matching geometric multiplicities (or equivalently, matching Jordan normal forms). Two matrices can have identical spectra yet differ in their internal eigenspace structure.",
    "transferable_technique": "When testing similarity: (1) First compute characteristic polynomials—different polynomials immediately rule out similarity. (2) For matrices with the same polynomial, check finer invariants like diagonalizability or Jordan form. (3) For computational efficiency, exploit special structure: triangular matrices have diagonal entries as eigenvalues; sparse matrices allow strategic cofactor expansion. (4) Remember that diagonalizable matrices are similar if and only if they have the same eigenvalues with the same multiplicities.",
    "common_errors": [
      "Concluding that A₂ and A₃ are similar because they have the same characteristic polynomial, without checking geometric multiplicities or Jordan forms.",
      "Making arithmetic errors when expanding det(A - λI), especially sign errors in cofactor expansion.",
      "Forgetting that upper/lower triangular matrices have their eigenvalues on the diagonal, leading to unnecessary computation.",
      "Confusing algebraic multiplicity (power in characteristic polynomial) with geometric multiplicity (dimension of eigenspace)."
    ],
    "variant_problems": [
      "Modify A₃ to make it diagonalizable: what is the minimal change to an entry that would increase the geometric multiplicity of eigenvalue 1 to 2?",
      "Find all 3×3 matrices similar to A₂ that are not diagonal. (Answer: all matrices with Jordan blocks of sizes 1,1,1 for eigenvalues 1,1,-1.)",
      "Given that A₁ has distinct eigenvalues, find its Jordan normal form explicitly and describe all matrices similar to A₁.",
      "Construct a 3×3 matrix with characteristic polynomial -(λ-1)²(λ+1) that IS similar to A₂."
    ],
    "deeper_connections": "This problem illustrates a fundamental theme in linear algebra: the tension between different notions of 'sameness' for matrices. Equality is too strict (depends on basis choice), while having the same determinant is too weak (doesn't capture structure). Similarity is the 'right' equivalence relation for understanding linear transformations as geometric objects independent of coordinates. The characteristic polynomial is the first similarity invariant students encounter, but it's incomplete—the full story requires the Jordan normal form, which completely classifies matrices up to similarity. This connects to representation theory, where understanding objects 'up to isomorphism' is central, and to moduli problems in algebraic geometry, where we classify objects by invariants."
  }
}
